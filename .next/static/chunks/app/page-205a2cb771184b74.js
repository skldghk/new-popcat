(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5738:function(e,t,n){Promise.resolve().then(n.bind(n,8618))},8618:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n(7437),l=n(2265),o=n(8472);let r={1:[1,2,3,4,5],2:[1,2,3,4,5],3:[1,2,3,4,5],4:[1,2,3,4,5],5:[1,2,3,4,5,6],6:[1,2,3,4,5,6]},s=()=>{let e=[];for(let t in r)r[t].forEach(n=>{e.push({class:"".concat(t,"학년 ").concat(n,"반"),clickCount:0})});return e};function c(){var e;let[t,n]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),[u,p]=(0,l.useState)(!1),[f,x]=(0,l.useState)(s()),[h,g]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let e=(await o.Z.get("/api/getClicks")).data.data;console.log("초기화 후 가져온 데이터:",e);let t=s().map(t=>{let n=e.find(e=>e.class===t.class);return n?{...t,clickCount:n.clickCount}:t});t.sort((e,t)=>t.clickCount-e.clickCount),x(t)}catch(e){console.error("Error fetching rankings:",e)}})()},[]);let k=e=>{d(e)},y=async()=>{if(t&&c){let e="".concat(t,"학년 ").concat(c,"반");p(!0),setTimeout(()=>{p(!1)},200);try{if((await fetch("/api/click",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({classId:e})})).ok)console.log("클릭 데이터가 성공적으로 저장되었습니다."),x(t=>{let n=t.map(t=>t.class===e?{...t,clickCount:t.clickCount+1}:t);return n.sort((e,t)=>t.clickCount-e.clickCount),n});else throw Error("클릭 데이터 저장 실패")}catch(e){console.error("클릭 데이터 저장 중 에러 발생:",e)}}else alert("학년과 반을 선택하세요.")};return(0,l.useEffect)(()=>{let e=e=>{h||(y(),g(!0))},t=e=>{g(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[t,c,h]),(0,l.useEffect)(()=>{let e=async()=>{try{await o.Z.post("/api/saveClicks",{clicks:f})}catch(e){console.error("Error saving clicks to DB:",e)}},t=setInterval(()=>{e()},1e3);return()=>clearInterval(t)},[f]),(0,i.jsxs)("div",{style:a.container,children:[t&&c&&(0,i.jsxs)("div",{style:a.selectedInfo,children:[t,"학년 ",c,"반"]}),t&&c?(0,i.jsxs)("div",{style:a.mainContent,children:[(0,i.jsx)("div",{style:a.rankingsContainer,children:(0,i.jsxs)("div",{style:a.rankings,children:[(0,i.jsx)("h2",{children:"순위표"}),(0,i.jsx)("ol",{children:f.map((e,t)=>(0,i.jsxs)("li",{children:[e.class,": ",e.clickCount,"회"]},t))})]})}),(0,i.jsx)("div",{style:a.result,children:(0,i.jsxs)("div",{style:a.imageContainer,onClick:y,children:[(0,i.jsx)("img",{id:"clickableImage",src:u?"/popcat-2.png":"/popcat.png",alt:"Popcat",style:a.image,draggable:"false",onDragStart:e=>e.preventDefault()}),(0,i.jsx)("div",{style:a.counter,children:(null===(e=f.find(e=>e.class==="".concat(t,"학년 ").concat(c,"반")))||void 0===e?void 0:e.clickCount)||0})]})})]}):(0,i.jsxs)("div",{style:a.selector,children:[(0,i.jsx)("h1",{children:"학년을 선택하세요"}),(0,i.jsxs)("select",{onChange:e=>{n(e.target.value),d(null)},value:t||"",style:a.select,children:[(0,i.jsx)("option",{value:"",disabled:!0,children:"학년 선택"}),[1,2,3,4,5,6].map(e=>(0,i.jsxs)("option",{value:e,children:[e,"학년"]},e))]}),t&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("h2",{children:[t,"학년"]}),(0,i.jsx)("div",{style:a.buttonsContainer,children:r[t].map(e=>(0,i.jsxs)("button",{onClick:()=>k(e),style:{...a.button,backgroundColor:c===e?"#0070f3":"#ccc"},children:[e,"반"]},e))})]})]})]})}let a={container:{display:"flex",flexDirection:"column",alignItems:"center",height:"100vh",backgroundColor:"#f0f0f0",position:"relative"},selectedInfo:{position:"absolute",top:"20px",left:"20px",fontSize:"24px",fontWeight:"bold"},selector:{textAlign:"center",backgroundColor:"#fff",padding:"20px",borderRadius:"10px",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)"},select:{padding:"10px",fontSize:"16px",margin:"20px 0"},buttonsContainer:{display:"flex",justifyContent:"center",flexWrap:"wrap"},button:{margin:"5px",padding:"10px 20px",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},mainContent:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},result:{textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",flex:1},imageContainer:{position:"relative",display:"inline-block",cursor:"pointer"},image:{width:"300px",height:"300px",borderRadius:"10px"},counter:{position:"absolute",top:"10px",left:"50%",transform:"translate(-50%, 0)",fontSize:"48px",color:"#000",fontWeight:"bold"},rankingsContainer:{display:"flex",flexDirection:"column",alignItems:"center",width:"200px",position:"absolute",left:"20px"},rankings:{textAlign:"center",backgroundColor:"#fff",padding:"10px",borderRadius:"10px",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)",width:"100%"}}}},function(e){e.O(0,[472,971,23,744],function(){return e(e.s=5738)}),_N_E=e.O()}]);